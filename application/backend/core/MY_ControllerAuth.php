<?//контроллер авторизацииclass  MY_ControllerAuth  extends  CI_Controller  {	var $current_permissions=array();	var $extra_permissions=array();		public function __construct(){		parent::__construct();				$this->load->model('extra_permissions_model');		$this->load->model('modules_model');				if(!$this->session->userdata('admin_user_id')&&!$this->session->userdata('super')){			$this->load->helper('cookie');				$this->load->model('users_model');				$cookie=false;			if($u_id=get_cookie('user_id')){				$maybe_user=$this->users_model->get_by_id($u_id);				$maybe_pass=get_cookie('password_hash');					if(isset($maybe_user['password'])&&$maybe_user['password']==$maybe_pass){					$this->session->set_userdata('admin_user_id',$u_id);					$cookie=true;				}			}			if(!$cookie){				redirect('login/');			}		}				$module_name=$this->uri->segment(1);		$module=$this->modules_model->get_by_fields(array("name"=>$module_name,));				if(isset($module['id'])&&$this->session->userdata('admin_user_id')){			$this->current_permissions=$this->modules_model->check_permission($this->session->userdata('admin_user_id'), $module['id']);			$this->extra_permissions=$this->extra_permissions_model->check_permission($this->session->userdata('admin_user_id'), $module['id']);			$this->extra_permissions=array_merge($this->extra_permissions, $this->extra_permissions_model->check_permission($this->session->userdata('admin_user_id'), 20));		}    }		public function get_top_menu(){		$this->load->model('modules_model');		return $this->modules_model->get_permission();	}}?>